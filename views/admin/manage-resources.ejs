<%- include('../partials/header') %>

<div class="admin-container container">
    <div class="admin-header">
        <h1 class="page-title">Manage Resources</h1>
    </div>

    <!-- ... (Upload Form remains the same) ... -->
    <div class="card" style="margin-bottom: 2rem;">
        <div class="card-body">
            <h3>Upload New Document</h3>
            <form action="/admin/resources/upload" method="POST" enctype="multipart/form-data" class="admin-form">
                <div class="form-group">
                    <label for="title">Document Title</label>
                    <input type="text" id="title" name="title" required>
                </div>
                <div class="form-group">
                    <label for="description">Description</label>
                    <textarea id="description" name="description" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="category">Category</label>
                    <select id="category" name="category">
                        <option value="Report">Report</option>
                        <option value="Brochure">Brochure</option>
                        <option value="Policy">Policy</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="documentFile">Select File (PDF, DOC, DOCX)</label>
                    <input type="file" id="documentFile" name="documentFile" required>
                </div>
                <button type="submit" class="btn btn-primary">Upload Resource</button>
            </form>
        </div>
    </div>

    <!-- Document List -->
    <h3>Uploaded Resources</h3>
    <table class="admin-table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Category</th>
                <th>Uploaded On</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <% if(documents && documents.length > 0) { %>
                <% documents.forEach(doc => { %>
                    <tr>
                        <td><%= doc.title %></td>
                        <td><%= doc.category %></td>
                        <td><%= new Date(doc.createdAt).toLocaleDateString() %></td>
                        <td>
                            <a href="<%= doc.filePath %>" target="_blank" class="btn-action edit">View</a>
                            <!-- THE FIX IS HERE: Added Edit link -->
                            <a href="/admin/resources/edit/<%= doc.id %>" class="btn-action edit">Edit</a>
                            <a href="/admin/resources/delete/<%= doc.id %>" class="btn-action delete" onclick="return confirm('Are you sure?');">Delete</a>
                        </td>
                    </tr>
                <% }) %>
            <% } else { %>
                <tr>
                    <td colspan="4">No resources have been uploaded yet.</td>
                </tr>
            <% } %>
        </tbody>
    </table>
</div>

<%- include('../partials/footer') %>